var cars=function(){var a={},e="/api/carros/",o="/api/marcas/",t=["#00af66","icon-check"],n=["#F33f3","icon-power_settings_new"];return a.message=function(a,e,o){$("#modal-alert").iziModal("destroy"),$("#modal-alert").iziModal({title:e,subtitle:a,icon:o[1],headerColor:o[0],width:600,timeout:5e3,timeoutProgressbar:!0,transitionIn:"fadeInDown",transitionOut:"fadeOutDown",pauseOnHover:!0}),$("#modal-alert").iziModal("open")},a.cadastro=function(){$("#modal-cadastro").iziModal({title:"Cadastro de veículos",icon:"icon-check",headerColor:"#00af66",width:600,transitionIn:"fadeInUp",transitionOut:"fadeOutDown"}),$(".modal-cadastro").on("click",function(){$(".modal-cadastrar input").val("");var a="";$.ajax({method:"GET",url:o,dataType:"json",success:function(e){var o=e.content;for(i in o)a+='<option value="'+o[i].id+'">',a+=o[i].name,a+="</option>";$("#marca").html(a)}}),$("#modal-cadastro").iziModal("open")})},a.edit=function(){$("#modal-editar").iziModal({title:"Alterar veículo",icon:"icon-check",headerColor:"#00af66",width:600,transitionIn:"fadeInUp",transitionOut:"fadeOutDown"}),$(document).on("opening","#modal-editar",function(t){var r="";$.ajax({method:"GET",url:o,dataType:"json",success:function(a){var e=a.content;for(i in e)r+='<option value="'+e[i].id+'">',r+=e[i].name,r+="</option>";$("#modal-editar #marca").html(r)}}),$.ajax({method:"GET",url:e+$(this).attr("data-id"),dataType:"json",success:function(a){var e=a.content;e&&($('.modal-alterar #marca option[value="'+e.marca+'"]').attr("selected","selected"),$(".modal-alterar #modelo").val(e.modelo),$(".modal-alterar #ano").val(e.ano))},error:function(e){a.message("Oops, ocorreu um problema.","Desculpe, estamos trabalhando para resolver, tente novamente mais tarde.",n)}})}),$(document).on("click",".edit",function(){$("#modal-editar").attr("data-id",$(this).attr("data-id")),$(".modal-alterar input").val(""),$("#modal-editar").iziModal("open")})},a.list=function(){var o="";$.ajax({method:"GET",url:e,dataType:"json",success:function(a){var e=a.content;for(i in e)o+='<li class="carros-item">',o+='<div class="thumb"></div>',o+='<span class="carros-modelo">',o+=e[i].modelo,o+="</span>",o+='<span class="carros-marca grid-only">',o+=e[i].marca,o+="</span>",o+=' <span class="carros-ano grid-only block">',o+=e[i].ano,o+="</span>",o+='<div class="pull-right">',o+='<span class="carros-stage stage" id="dropdownOptions" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">',o+='<i class="fa fa-cog" aria-hidden="true"></i>',o+="</span>",o+='<div class="dropdown-menu" aria-labelledby="dropdownOptions">',o+='<a class="dropdown-item edit" href="#" data-id="'+e[i].id+'">Editar</a>',o+='<a class="dropdown-item delete" href="#" data-id="'+e[i].id+'">Deletar</a>',o+="</div></span>",o+="</div>",o+="</li>";$("ul.carros").html(o)},error:function(e){a.message("Oops, ocorreu um problema.","Desculpe, estamos trabalhando para resolver, tente novamente mais tarde.",n)}})},a.signup=function(){$(document).on("click","#modal-cadastro .btn",function(o){o.preventDefault();$(this);$.ajax({method:"POST",url:e,data:$(".modal-cadastrar").serialize(),dataType:"json",success:function(e){e.content&&(a.list(),a.message("Sucesso!",e.message,t))},error:function(e){a.message("Oops, ocorreu um problema.","Desculpe, estamos trabalhando para resolver, tente novamente mais tarde.",n)}})})},a.update=function(){$(document).on("click","#modal-editar .btn",function(o){o.preventDefault();$(this);$.ajax({method:"PUT",url:e+$("#modal-editar").attr("data-id"),data:$(".modal-alterar").serialize(),dataType:"json",success:function(e){e.content&&(a.list(),a.message("Sucesso!",e.message,t))},error:function(e){a.message("Oops, ocorreu um problema.","Desculpe, estamos trabalhando para resolver, tente novamente mais tarde.",n)}})})},a.delete=function(){$(document).on("click",".delete",function(){var o=$(this);$.ajax({method:"DELETE",url:e+o.attr("data-id"),dataType:"json",success:function(e){e.content?(o.closest("li").remove(),a.message("Sucesso.","Carro excluído com sucesso!",t)):a.message("Oops, ocorreu um problema.","Desculpe, estamos trabalhando para resolver, tente novamente mais tarde.",n)},error:function(e){a.message("Oops, ocorreu um problema.","Desculpe, estamos trabalhando para resolver, tente novamente mais tarde.",n)}})})},a.info=function(){$(document).on("click",".info",function(){$("#info").iziModal({title:"Informações",icon:"icon-check",headerColor:"#6f8ba8",width:600,transitionIn:"fadeInUp",transitionOut:"fadeOutDown"}),$("#info").iziModal("open")})},{init:function(){a.list(),a.cadastro(),a.delete(),a.signup(),a.edit(),a.update(),a.info()}}}();$(function(){cars.init()});