(this["webpackJsonpdashboard-estadao"]=this["webpackJsonpdashboard-estadao"]||[]).push([[0],{44:function(e,t,r){"use strict";r.r(t);r(30);var a=r(0),n=r(13),c=r(3),s=r(9),i=r(1),o=function(){return Object(i.jsxs)("div",{className:"jumbotron",children:[Object(i.jsx)("h1",{children:"Dashboard Carros"}),Object(i.jsx)("p",{children:"Painel para editar, criar e deletar carros"})]})},d=r(11),l=r(7),u=(r(17),r(2)),b=r.n(u),h=function(e){return Object(i.jsxs)("table",{className:"table",children:[Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{children:"Modelo"}),Object(i.jsx)("th",{children:"Ano"}),Object(i.jsx)("th",{children:"Marca"}),Object(i.jsx)("th",{children:"Remover"})]})}),Object(i.jsx)("tbody",{children:e.cars.map((function(t){return Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:Object(i.jsx)(l.b,{to:"/carro/".concat(t.id),children:t.title})}),Object(i.jsx)("td",{children:t.year}),Object(i.jsx)("td",{children:t.brandName}),Object(i.jsx)("td",{children:Object(i.jsx)("button",{type:"button",className:"btn btn-danger",onClick:function(){return e.onDelete(t.id)},children:"X"})})]},t.id)}))})]})};h.prototype={cars:b.a.arrayOf(b.a.shape({id:b.a.number.isRequired,title:b.a.string.isRequired,year:b.a.number.isRequired,brandId:b.a.number.isRequired,brandName:b.a.string.isRequired})).isRequired,onDelete:b.a.func.isRequired};var j=h,O=r(23),m=r(24),p=r(29),f=r(28),g=r(25),x=new(r(26).Dispatcher),v={CREATE_CAR:"CREATE_CAR",LOAD_CARS:"LOAD_CARS",UPDATE_CAR:"UPDATE_CAR",DELETE_CAR:"DELETE_CAR",LOAD_BRANDS:"LOAD_BRANDS"},C="change",y=[],R=[],A=new(function(e){Object(p.a)(r,e);var t=Object(f.a)(r);function r(){return Object(O.a)(this,r),t.apply(this,arguments)}return Object(m.a)(r,[{key:"addChangeListener",value:function(e){this.on(C,e)}},{key:"removeChangeListener",value:function(e){this.removeListener(C,e)}},{key:"emitChange",value:function(){this.emit(C)}},{key:"getCars",value:function(){return y}},{key:"getCarById",value:function(e){return y.find((function(t){return t.id===parseInt(e,10)}))}},{key:"getBrands",value:function(){return R}}]),r}(g.EventEmitter));x.register((function(e){switch(e.actionType){case v.CREATE_CAR:y.push(e.car),A.emitChange();break;case v.LOAD_CARS:y=e.cars,A.emitChange();break;case v.UPDATE_CAR:y=y.map((function(t){return t.id===e.car.id?e.car:t})),A.emitChange();break;case v.DELETE_CAR:y=y.filter((function(t){return t.id!==parseInt(e.carID,10)})),A.emitChange();break;case v.LOAD_BRANDS:R=e.brands,A.emitChange()}}));var E=A,N=r(12),D=r(20),S=r.n(D),L=r(27);function k(e){return T.apply(this,arguments)}function T(){return(T=Object(L.a)(S.a.mark((function e(t){var r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=2;break}return e.abrupt("return",t.json());case 2:if(200===t.status){e.next=8;break}return e.next=5,t.json();case 5:throw r=e.sent,s.b.error(r.message),new Error(r.message);case 8:throw new Error("Network response was not ok.");case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){throw console.error("API call failed. "+e),e}var I="http://localhost:8080/api/v1/carros/";function q(e){return function(e){return fetch(I+(e.id||""),{method:e.id?"PUT":"POST",headers:{"content-type":"application/json"},body:JSON.stringify(Object(N.a)(Object(N.a)({},e),{},{year:parseInt(e.year,10),brandId:parseInt(e.brandId,10)}))}).then(k).catch(_)}(e).then((function(t){x.dispatch({actionType:e.id?v.UPDATE_CAR:v.CREATE_CAR,car:t.data})}))}function w(){return fetch(I).then(k).catch(_).then((function(e){x.dispatch({actionType:v.LOAD_CARS,cars:e.data})}))}function P(e){return(t=e,fetch(I+t,{method:"DELETE"}).then(k).catch(_)).then((function(){x.dispatch({actionType:v.DELETE_CAR,carID:e})}));var t}var B=function(){var e=Object(a.useState)(E.getCars()),t=Object(d.a)(e,2),r=t[0],n=t[1];function c(){n(E.getCars())}return Object(a.useEffect)((function(){return E.addChangeListener(c),0===r.length&&w(),function(){return E.removeChangeListener(c)}}),[r.length]),Object(i.jsxs)("div",{className:"py-5",children:[Object(i.jsxs)("div",{className:"d-flex justify-content-md-between flex-column flex-md-row",children:[Object(i.jsx)("h2",{children:"Listagem de carros"}),Object(i.jsx)(l.b,{to:"/carro",className:"btn btn-primary mb-3",children:"Adicionar carro"})]}),Object(i.jsx)(j,{cars:r,onDelete:function(e){P(e).then((function(){return s.b.success("Carro deletado!")}))}})]})},M=function(e){return"/404"!==e.match.path&&window.location.replace("/404"),Object(i.jsxs)("div",{className:"py-5",children:[Object(i.jsx)("h2",{children:"P\xe1gina n\xe3o encontrada"}),Object(i.jsx)("p",{className:"mt-5",children:Object(i.jsx)(l.b,{to:"/",className:"btn btn-primary",children:"Voltar para home"})})]})},U=r(14),J=function(e){var t="form-group";return e.error.length>0&&(t+=" has-error"),Object(i.jsxs)("div",{className:t,children:[Object(i.jsx)("label",{htmlFor:e.id,children:e.label}),Object(i.jsx)("div",{className:"field",children:Object(i.jsx)("input",{type:"text",id:e.id,name:e.name,className:"form-control",value:e.value,onChange:e.onChange})}),e.error&&Object(i.jsx)("div",{className:"alert alert-danger",children:e.error})]})};J.prototype={id:b.a.string.isRequired,name:b.a.string.isRequired,label:b.a.string.isRequired,onChange:b.a.func.isRequired,value:b.a.string,error:b.a.string},J.defaultProps={error:""};var F=J,H=function(e){var t="form-group";return e.error.length>0&&(t+=" has-error"),Object(i.jsxs)("div",{className:t,children:[Object(i.jsx)("label",{htmlFor:e.id,children:e.label}),Object(i.jsx)("div",{className:"field",children:Object(i.jsxs)("select",{name:e.name,value:e.value,onChange:e.onChange,className:"form-control",children:[Object(i.jsx)("option",{value:"",children:e.defaultOption}),e.options.map((function(e){return Object(i.jsx)("option",{value:e.value,children:e.text},e.value)}))]})}),e.error&&Object(i.jsx)("div",{className:"alert alert-danger",children:e.error})]})};H.prototype={name:b.a.string.isRequired,label:b.a.string.isRequired,onChange:b.a.func.isRequired,value:b.a.string,error:b.a.string,defaultOption:b.a.string,options:b.a.arrayOf(b.a.object)},H.defaultProps={error:""};var V=H,X=function(e){return Object(i.jsxs)("form",{onSubmit:e.onSubmit,children:[Object(i.jsx)(F,{id:"title",name:"title",label:"Modelo",value:e.car.title,onChange:e.onChange,error:e.errors.title}),Object(i.jsx)(F,{id:"year",name:"year",label:"Ano",value:e.car.year,onChange:e.onChange,error:e.errors.year}),Object(i.jsx)(V,{name:"brandId",label:"Marca",value:e.car.brandId||"",defaultOption:"Selecione uma marca",options:e.brands.map((function(e){return{value:e.id,text:e.name}})),onChange:e.onChange,error:e.errors.brandId}),Object(i.jsx)("input",{type:"submit",value:"Salvar",className:"btn btn-primary"})]})};X.prototype={car:b.a.object.isRequired,onSubmit:b.a.func.isRequired,onChange:b.a.func.isRequired,errors:b.a.object.isRequired};var z=X;function G(){return fetch("http://localhost:8080/api/v1/marcas/").then(k).catch(_).then((function(e){x.dispatch({actionType:v.LOAD_BRANDS,brands:e.data})}))}var K=function(e){var t=Object(a.useState)({}),r=Object(d.a)(t,2),n=r[0],c=r[1],o=Object(a.useState)(E.getCars()),l=Object(d.a)(o,2),u=l[0],b=l[1],h=Object(a.useState)({id:null,title:"",year:"",brandId:null}),j=Object(d.a)(h,2),O=j[0],m=j[1],p=Object(a.useState)(E.getBrands()),f=Object(d.a)(p,2),g=f[0],x=f[1];function v(){b(E.getCars()),x(E.getBrands())}return Object(a.useEffect)((function(){E.addChangeListener(v);var t=e.match.params.id;return 0===u.length?w():t&&m(E.getCarById(t)),0===g.length&&G(),function(){return E.removeChangeListener(v)}}),[u.length,g.length,e.match.params.id]),Object(i.jsxs)("div",{className:"py-5",children:[Object(i.jsxs)("h2",{children:[O.id?"Editar":"Adicionar"," carro"]}),Object(i.jsx)(z,{car:O,brands:g,errors:n,onChange:function(e){var t=e.target;m(Object(N.a)(Object(N.a)({},O),{},Object(U.a)({},t.name,t.value)))},onSubmit:function(t){t.preventDefault(),function(){var e={};return O.title||(e.title="Modelo \xe9 obrigat\xf3rio"),O.year||(e.year="Ano \xe9 obrigat\xf3rio"),O.brandId||(e.brandId="Marca \xe9 obrigat\xf3rio"),c(e),0===Object.keys(e).length}()&&q(O).then((function(){e.history.push("/carros"),s.b.success("Carro salvo!")})).catch((function(e){return s.b.success(e)}))}})]})},Q=function(){var e={color:"orange"};return Object(i.jsxs)("nav",{children:[Object(i.jsx)(l.c,{exact:!0,to:"/",activeClassName:"active",activeStyle:e,children:"Home"})," | ",Object(i.jsx)(l.c,{to:"/carros",activeClassName:"active",activeStyle:e,children:"Carros"})," | "]})},W=function(){return Object(i.jsxs)("div",{className:"container",children:[Object(i.jsx)(s.a,{autoClose:3e3,hideProgressBar:!0}),Object(i.jsx)(Q,{}),Object(i.jsxs)(c.c,{children:[Object(i.jsx)(c.a,{exact:!0,path:"/",component:o}),Object(i.jsx)(c.a,{path:"/carros",component:B}),Object(i.jsx)(c.a,{path:"/carro/:id",component:K}),Object(i.jsx)(c.a,{path:"/carro",component:K}),Object(i.jsx)(c.a,{path:"/404",component:M,status:404}),Object(i.jsx)(c.a,{component:M,status:404})]})]})};Object(n.render)(Object(i.jsx)(l.a,{children:Object(i.jsx)(W,{})}),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.f7687e1e.chunk.js.map